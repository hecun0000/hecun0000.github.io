<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>csv和excel读取和下载 | hecun&#39;s blog</title>
    <meta name="description" content="进击的程序源-hecun">
    <link rel="icon" type="image/x-icon" href="/img/logo.ico">
  <link rel="manifest" href="/manifest.json">
  <link rel="apple-touch-icon" href="/img/logo.ico">
  <link rel="stylesheet" type="text/css" href="/css/main.css">
  <mate name="keywords" content="进击的程序源,hecun,禾寸"></mate>
    
    <link rel="preload" href="/assets/css/0.styles.ccc4724e.css" as="style"><link rel="preload" href="/assets/js/app.c2692aa7.js" as="script"><link rel="preload" href="/assets/js/7.ee9b7330.js" as="script"><link rel="preload" href="/assets/js/2.55ffe7b1.js" as="script"><link rel="preload" href="/assets/js/50.98492dc0.js" as="script"><link rel="prefetch" href="/assets/js/1.6d24a22a.js"><link rel="prefetch" href="/assets/js/10.b80e02fd.js"><link rel="prefetch" href="/assets/js/11.22b74af9.js"><link rel="prefetch" href="/assets/js/12.474b79db.js"><link rel="prefetch" href="/assets/js/13.23a8ba9e.js"><link rel="prefetch" href="/assets/js/14.8437854b.js"><link rel="prefetch" href="/assets/js/15.eb2c7e6a.js"><link rel="prefetch" href="/assets/js/16.14cc9f96.js"><link rel="prefetch" href="/assets/js/17.178deaf5.js"><link rel="prefetch" href="/assets/js/18.b922d114.js"><link rel="prefetch" href="/assets/js/19.6967fed4.js"><link rel="prefetch" href="/assets/js/20.f9680dc5.js"><link rel="prefetch" href="/assets/js/21.c28a6930.js"><link rel="prefetch" href="/assets/js/22.973aab73.js"><link rel="prefetch" href="/assets/js/23.cb215d9f.js"><link rel="prefetch" href="/assets/js/24.b3c058a2.js"><link rel="prefetch" href="/assets/js/25.34e23410.js"><link rel="prefetch" href="/assets/js/26.ab9e6475.js"><link rel="prefetch" href="/assets/js/27.64be3436.js"><link rel="prefetch" href="/assets/js/28.d2524c5b.js"><link rel="prefetch" href="/assets/js/29.04fa85aa.js"><link rel="prefetch" href="/assets/js/3.53c1b047.js"><link rel="prefetch" href="/assets/js/30.5bccadb5.js"><link rel="prefetch" href="/assets/js/31.0a4f2335.js"><link rel="prefetch" href="/assets/js/32.4568bb0b.js"><link rel="prefetch" href="/assets/js/33.f1ee24e2.js"><link rel="prefetch" href="/assets/js/34.6ead242e.js"><link rel="prefetch" href="/assets/js/35.27efa193.js"><link rel="prefetch" href="/assets/js/36.362e5f5c.js"><link rel="prefetch" href="/assets/js/37.0e4794b1.js"><link rel="prefetch" href="/assets/js/38.9fc75844.js"><link rel="prefetch" href="/assets/js/39.894a1b86.js"><link rel="prefetch" href="/assets/js/40.e2708e69.js"><link rel="prefetch" href="/assets/js/41.a3603a43.js"><link rel="prefetch" href="/assets/js/42.cf7dc3ee.js"><link rel="prefetch" href="/assets/js/43.363d291a.js"><link rel="prefetch" href="/assets/js/44.8d29c24e.js"><link rel="prefetch" href="/assets/js/45.2db43ddc.js"><link rel="prefetch" href="/assets/js/46.0fba0e84.js"><link rel="prefetch" href="/assets/js/47.10f4922e.js"><link rel="prefetch" href="/assets/js/48.56fcc68c.js"><link rel="prefetch" href="/assets/js/49.11209a48.js"><link rel="prefetch" href="/assets/js/5.75ce7176.js"><link rel="prefetch" href="/assets/js/51.879e5063.js"><link rel="prefetch" href="/assets/js/52.69cb96eb.js"><link rel="prefetch" href="/assets/js/53.a0d23912.js"><link rel="prefetch" href="/assets/js/54.e84d6748.js"><link rel="prefetch" href="/assets/js/55.6a87de8d.js"><link rel="prefetch" href="/assets/js/56.0e16ce35.js"><link rel="prefetch" href="/assets/js/57.89321769.js"><link rel="prefetch" href="/assets/js/58.4c8ae67e.js"><link rel="prefetch" href="/assets/js/59.345b425f.js"><link rel="prefetch" href="/assets/js/6.f8e51914.js"><link rel="prefetch" href="/assets/js/60.350e74f0.js"><link rel="prefetch" href="/assets/js/61.740d651d.js"><link rel="prefetch" href="/assets/js/62.ba2263d7.js"><link rel="prefetch" href="/assets/js/63.b248662e.js"><link rel="prefetch" href="/assets/js/64.bf046848.js"><link rel="prefetch" href="/assets/js/65.dbff5786.js"><link rel="prefetch" href="/assets/js/66.bf57fc70.js"><link rel="prefetch" href="/assets/js/67.42d8239d.js"><link rel="prefetch" href="/assets/js/68.fc59e5ca.js"><link rel="prefetch" href="/assets/js/69.08badfb0.js"><link rel="prefetch" href="/assets/js/70.5e3539ab.js"><link rel="prefetch" href="/assets/js/71.fc913d54.js"><link rel="prefetch" href="/assets/js/72.9406c0cf.js"><link rel="prefetch" href="/assets/js/73.b3485dd2.js"><link rel="prefetch" href="/assets/js/74.f699d6d0.js"><link rel="prefetch" href="/assets/js/75.3b6cf9de.js"><link rel="prefetch" href="/assets/js/76.dae9c229.js"><link rel="prefetch" href="/assets/js/77.a8ab0c06.js"><link rel="prefetch" href="/assets/js/78.6d217328.js"><link rel="prefetch" href="/assets/js/79.4d5870b3.js"><link rel="prefetch" href="/assets/js/8.096c476a.js"><link rel="prefetch" href="/assets/js/80.9fd35370.js"><link rel="prefetch" href="/assets/js/81.ac815421.js"><link rel="prefetch" href="/assets/js/82.918ca1dd.js"><link rel="prefetch" href="/assets/js/83.a6957825.js"><link rel="prefetch" href="/assets/js/84.34be1d45.js"><link rel="prefetch" href="/assets/js/85.f591015b.js"><link rel="prefetch" href="/assets/js/86.4b4fbaad.js"><link rel="prefetch" href="/assets/js/87.24552fe7.js"><link rel="prefetch" href="/assets/js/88.1fe39b72.js"><link rel="prefetch" href="/assets/js/89.b6257e02.js"><link rel="prefetch" href="/assets/js/9.89b67f33.js"><link rel="prefetch" href="/assets/js/90.14b158b9.js"><link rel="prefetch" href="/assets/js/91.00cf1ef4.js"><link rel="prefetch" href="/assets/js/92.44b6910d.js"><link rel="prefetch" href="/assets/js/93.2b920839.js"><link rel="prefetch" href="/assets/js/94.e03699fe.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ccc4724e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">hecun's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/js/" class="nav-link router-link-active">JavaScript</a></div><div class="nav-item"><a href="/vue/" class="nav-link">VUE</a></div><div class="nav-item"><a href="/css/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/node/" class="nav-link">node</a></div><div class="nav-item"><a href="/think/" class="nav-link">随想</a></div><div class="nav-item"><a href="https://github.com/hecun0000" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><a href="/js/" class="nav-link router-link-active">JavaScript</a></div><div class="nav-item"><a href="/vue/" class="nav-link">VUE</a></div><div class="nav-item"><a href="/css/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/node/" class="nav-link">node</a></div><div class="nav-item"><a href="/think/" class="nav-link">随想</a></div><div class="nav-item"><a href="https://github.com/hecun0000" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>csv和excel读取和下载</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/csv%E5%92%8Cexcel%E7%9A%84%E8%AF%BB%E5%8F%96%E5%92%8C%E4%B8%8B%E8%BD%BD.html#先来个例子" class="sidebar-link">先来个例子</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/js/csv%E5%92%8Cexcel%E7%9A%84%E8%AF%BB%E5%8F%96%E5%92%8C%E4%B8%8B%E8%BD%BD.html#csv的导入" class="sidebar-link">csv的导入</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/js/csv%E5%92%8Cexcel%E7%9A%84%E8%AF%BB%E5%8F%96%E5%92%8C%E4%B8%8B%E8%BD%BD.html#既然都读取出来，下载？" class="sidebar-link">既然都读取出来，下载？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/js/csv%E5%92%8Cexcel%E7%9A%84%E8%AF%BB%E5%8F%96%E5%92%8C%E4%B8%8B%E8%BD%BD.html#excel文件读取" class="sidebar-link">excel文件读取</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/js/csv%E5%92%8Cexcel%E7%9A%84%E8%AF%BB%E5%8F%96%E5%92%8C%E4%B8%8B%E8%BD%BD.html#excel文件导出" class="sidebar-link">Excel文件导出</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="csv和excel读取和下载"><a href="#csv和excel读取和下载" class="header-anchor">#</a> csv和excel读取和下载</h1> <p>在html5中，DOM给文件中添加了一个files集合,在选取文件中，files中包含一个File对象，每个对象都有下列属性：</p> <ul><li>name: 本地文件的文件名</li> <li>size：文件的大小</li> <li>type: 字符串，文件的MIME类型</li> <li>lastModifiedDate: 字符串，文件上一次被修改的时间</li></ul> <p>同时，使用FileReader对象，web应用程序可以异步的读取存储在用户计算机上的文件(或者原始数据缓冲)内容，可以使用File对象或者Blob对象来指定所要处理的文件或数据。FileReader 提供了如下 几个方法。</p> <ul><li>readAsText(file,encoding)：以纯文本形式读取文件，将读取到的文本保存在 result 属 性中。第二个参数用于指定编码类型，是可选的。</li> <li>readAsDataURL(file)：读取文件并将文件以数据 URI的形式保存在 result 属性中。</li> <li>readAsBinaryString(file)：读取文件并将一个字符串保存在 result 属性中，字符串中的 每个字符表示一字节。</li> <li>readAsArrayBuffer(file)：读取文件并将一个包含文件内容的 ArrayBuffer 保存在 result 属性中。 这些读取文件的方法为灵活地处理文件数据提供了极大便利。例如，可以读取图像文件并将其保存 为数据 URI，以便将其显示给用户，或者为了解析方便，可以将文件读取为文本形式。</li></ul> <h2 id="先来个例子"><a href="#先来个例子" class="header-anchor">#</a> 先来个例子</h2> <p>需求：若读取文件为图片，则以img展示出来，其他情况则以text的形式输出。</p> <ol><li>若要读取文件，首先需要一个input元素</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>files-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="2"><li>接下来，若读取的文件为图片，使用readAsDataURL将其转化为图片，否则转化为text。 相应的转化结果会保存在result中。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/image/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 选择文件类型为图片</span>
    reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token string">&quot;image&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// 其他文件类型，并指定编码类型</span>
    reader<span class="token punctuation">.</span><span class="token function">readAsText</span><span class="token punctuation">(</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'gb2312'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    type <span class="token operator">=</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><ol start="3"><li>读取完成后，将图片利用img标签展示出来；若为text则挂载在页面上</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">&quot;image&quot;</span><span class="token punctuation">:</span>
            html <span class="token operator">=</span> <span class="token string">&quot;&lt;img src=\&quot;&quot;</span> <span class="token operator">+</span> reader<span class="token punctuation">.</span>result <span class="token operator">+</span> <span class="token string">&quot;\&quot;&gt;&quot;</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">:</span>
            html <span class="token operator">=</span> reader<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    output<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><a href="https://hecun0000.github.io/Jcss/file/readFile.html" target="_blank" rel="noopener noreferrer">演示链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>读取图片</strong></p> <p><img src="http://static.hecun.site/IMG.png" alt="image"></p> <p><strong>读取csv文件</strong></p> <p><img src="http://static.hecun.site/csv.png" alt="image"></p> <pre><code>在利用readAsText进行读取的时候，要指定一下编码形式。如readAsText(files[0], 'gb2312');   
</code></pre> <h2 id="csv的导入"><a href="#csv的导入" class="header-anchor">#</a> csv的导入</h2> <pre><code>csv文件的特点： 每一行用换行符进行分隔，每一行的数据中每一项利用逗号分隔。
</code></pre> <p>上面已经可以将csv作为text进行输出了。下来继续拿取数据。</p> <p>利用上面所说的csv的特点就可以利用js进行循环遍历拿到每一项的数据。</p> <p><a href="https://hecun0000.github.io/Jcss/file/cvsRead.html" target="_blank" rel="noopener noreferrer">演示链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>其中，我将CVS中的数据转化后，并拼在了table元素中：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 将读取的数据转化为table</span>
<span class="token keyword">function</span> <span class="token function">textToCsv</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> allRows <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\n/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> table <span class="token operator">=</span> <span class="token string">'&lt;table&gt;'</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> singleRow <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> singleRow <span class="token operator">&lt;</span> allRows<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> singleRow<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>singleRow <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            table <span class="token operator">+=</span> <span class="token string">'&lt;thead&gt;'</span><span class="token punctuation">;</span>
            table <span class="token operator">+=</span> <span class="token string">'&lt;tr&gt;'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            table <span class="token operator">+=</span> <span class="token string">'&lt;tr&gt;'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">var</span> rowCells <span class="token operator">=</span> allRows<span class="token punctuation">[</span>singleRow<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> rowCell <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> rowCell <span class="token operator">&lt;</span> rowCells<span class="token punctuation">.</span>length<span class="token punctuation">;</span> rowCell<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>singleRow <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 表格的标题</span>
                table <span class="token operator">+=</span> <span class="token string">'&lt;th&gt;'</span><span class="token punctuation">;</span>
                table <span class="token operator">+=</span> rowCells<span class="token punctuation">[</span>rowCell<span class="token punctuation">]</span><span class="token punctuation">;</span>
                table <span class="token operator">+=</span> <span class="token string">'&lt;/th&gt;'</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">// 表格内容</span>
                table <span class="token operator">+=</span> <span class="token string">'&lt;td&gt;'</span><span class="token punctuation">;</span>
                table <span class="token operator">+=</span> rowCells<span class="token punctuation">[</span>rowCell<span class="token punctuation">]</span><span class="token punctuation">;</span>
                table <span class="token operator">+=</span> <span class="token string">'&lt;/td&gt;'</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>singleRow <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            table <span class="token operator">+=</span> <span class="token string">'&lt;/tr&gt;'</span><span class="token punctuation">;</span>
            table <span class="token operator">+=</span> <span class="token string">'&lt;/thead&gt;'</span><span class="token punctuation">;</span>
            table <span class="token operator">+=</span> <span class="token string">'&lt;tbody&gt;'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            table <span class="token operator">+=</span> <span class="token string">'&lt;/tr&gt;'</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    table <span class="token operator">+=</span> <span class="token string">'&lt;/tbody&gt;'</span><span class="token punctuation">;</span>
    table <span class="token operator">+=</span> <span class="token string">'&lt;/table&gt;'</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'table'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> table<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>效果图如下：</strong></p> <p><img src="http://static.hecun.site/csvout.png" alt="image"></p> <h2 id="既然都读取出来，下载？"><a href="#既然都读取出来，下载？" class="header-anchor">#</a> 既然都读取出来，下载？</h2> <p>关于下载的操作，可以借助于a标签。先介绍下相关的属性：</p> <ul><li>download: 用于指定下载的文件名</li> <li>href：为所要下载的文件的链接（需为本地链接）</li></ul> <p>上一个列子的下载就是用的上面的做法：</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./file/会员.csv<span class="token punctuation">&quot;</span></span> <span class="token attr-name">download</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>demo.csv<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>下载测试文件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>先准备数据
csv文件的头部数据：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> head <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">'姓名（最多10个字）'</span><span class="token punctuation">,</span> <span class="token string">'手机号（必填）'</span><span class="token punctuation">,</span> <span class="token string">'等级'</span><span class="token punctuation">,</span> <span class="token string">'生日（比如：1989/08/08 或 1989-08-08）'</span><span class="token punctuation">,</span> <span class="token string">'积分（限整数）'</span><span class="token punctuation">]</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>csv文件的主体数据：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> people <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;吴三桂&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;phone&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;18709237410&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;黄金&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;birthday&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1989/8/5&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;points&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;100&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;史泰龙&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;phone&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;18709237401&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;青铜2&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;birthday&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1993/9/6&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;points&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;300&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;阿超&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;phone&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;18883920287&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;白金&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;birthday&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1993/9/3&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;points&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;500&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>下来就是数据的格式转换：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//. 将数据push到大数组中 </span>
<span class="token keyword">var</span> p <span class="token operator">=</span> people<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> p<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    head<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>phone<span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>level<span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>birthday<span class="token punctuation">,</span> p<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>points<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 按照csv文件内容格式，把每个数组用 , 连接，形成一行，并存入新数组 </span>
<span class="token keyword">var</span> csvRows <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> head<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    csvRows<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>head<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//s4. 把新数组用 \n 回车连接 </span>
<span class="token keyword">var</span> csvString <span class="token operator">=</span> csvRows<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><p>最后实现下载：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//利用a标签实现下载</span>
<span class="token keyword">function</span> <span class="token function">saveAs</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> fileName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token keyword">var</span> tmpa <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    tmpa<span class="token punctuation">.</span>download <span class="token operator">=</span> fileName <span class="token operator">||</span> <span class="token string">&quot;下载.csv&quot;</span><span class="token punctuation">;</span>
    tmpa<span class="token punctuation">.</span>href <span class="token operator">=</span><span class="token string">'data:attachment/csv,'</span> <span class="token operator">+</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//绑定a标签</span>
    tmpa<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//模拟点击实现下载</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//延时释放</span>
        <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">revokeObjectURL</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//用URL.revokeObjectURL()来释放这个object URL</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="https://hecun0000.github.io/Jcss/file/csvDownload.html" target="_blank" rel="noopener noreferrer">演示链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><br> <strong>效果图</strong></p> <p><img src="http://static.hecun.site/csv12321.png" alt="image"></p> <p>另外，
将json文件转化为csv格式可以利用<a href="https://github.com/zemirco/json2csv" target="_blank" rel="noopener noreferrer">json2csv<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>下面将使用<a href="https://docs.sheetjs.com/#sheetjs-js-xlsx" target="_blank" rel="noopener noreferrer">js-xlsx<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>对csv文件进行操作：</p> <h2 id="excel文件读取"><a href="#excel文件读取" class="header-anchor">#</a> excel文件读取</h2> <p>xlsx相关api:</p> <ul><li>XLSX.utils.sheet_to_json方法解析表格对象返回相应的JSON数据</li> <li>XLSX.read()以二进制流方式读取excel数据</li></ul> <p>在JavaScript中，有2个函数分别用来处理解码和编码base64 字符串：</p> <ul><li>atob() 函数能够解码通过base-64编码的字符串数据。</li> <li>btoa() 函数能够从二进制数据“字符串”创建一个base-64编码的ASCII字符串。</li></ul> <p>步骤：</p> <ol><li>readAsArrayBuffer可以将读取的数据转化为二进制数据；</li> <li>通过btoa()将数据转化为base64格式；</li> <li>然后结合XLSX.utils.sheet_to_json转化为json</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> wb<span class="token punctuation">;</span><span class="token comment">//读取完成的数据</span>
 <span class="token comment">//导入</span>
<span class="token keyword">function</span> <span class="token function">importf</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">.</span>files<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> f <span class="token operator">=</span> obj<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    reader<span class="token punctuation">.</span><span class="token function">readAsArrayBuffer</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
    reader<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> data <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
        <span class="token keyword">var</span> wb <span class="token operator">=</span><span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token function">btoa</span><span class="token punctuation">(</span><span class="token function">fixedData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">'base64'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//将数据转化为二进制</span>
        <span class="token comment">//wb.SheetNames[0]是获取Sheets中第一个Sheet的名字</span>
        <span class="token comment">//wb.Sheets[Sheet名]获取第一个Sheet的数据</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;excel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">XLSX</span><span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">sheet_to_json</span><span class="token punctuation">(</span>wb<span class="token punctuation">.</span>Sheets<span class="token punctuation">[</span>wb<span class="token punctuation">.</span>SheetNames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//文件流转BinaryString</span>
<span class="token keyword">function</span> <span class="token function">fixedData</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">let</span> l <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">const</span> w <span class="token operator">=</span> <span class="token number">10240</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> l <span class="token operator">&lt;</span> data<span class="token punctuation">.</span>byteLength <span class="token operator">/</span> w<span class="token punctuation">;</span> <span class="token operator">++</span>l<span class="token punctuation">)</span> o <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>l <span class="token operator">*</span> w<span class="token punctuation">,</span>
        l <span class="token operator">*</span> w <span class="token operator">+</span> w<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    o <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>l <span class="token operator">*</span> w<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> o
<span class="token punctuation">}</span>
</code></pre></div><p>效果图预览：
<img src="http://static.hecun.site/xlsxsave.png" alt="image"> <a href="https://hecun0000.github.io/Jcss/file/xlsxRead.html" target="_blank" rel="noopener noreferrer">查看演示<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>附上一个vue-element-admin关于Excel文件读取的源码：
<a href="https://github.com/PanJiaChen/vue-element-admin/blob/master/src/components/UploadExcel/index.vue" target="_blank" rel="noopener noreferrer">查看链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="excel文件导出"><a href="#excel文件导出" class="header-anchor">#</a> Excel文件导出</h2> <p>这里依然会用到js-xlsx, 文件下载采用FileSaver.js</p> <div class="language-html extra-class"><pre class="language-html"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>downloadExl(people)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>导出<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol><li>数据准备</li></ol> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">var</span> people <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;吴三桂&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;phone&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;18709237410&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;黄金&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;birthday&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1989/8/5&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;points&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;100&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;史泰龙&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;phone&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;18709237401&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;青铜2&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;birthday&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1993/9/6&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;points&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;300&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;阿超&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;phone&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;18883920287&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;level&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;白金&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;birthday&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1993/9/3&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;points&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;500&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><p>下来定义一个wb保存导出数据</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> wb <span class="token operator">=</span> <span class="token punctuation">{</span>
  SheetNames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token comment">//标题名</span>
  Sheets<span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>               <span class="token comment">//保存表内的数据</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>XLSX.utils.json_to_sheet(people)：可以将json对象转化为工作表；将转化的结果赋值非 wb.Sheets['Sheet1']</li></ol> <p>这里将转化后的结果打印出来</p> <p><img src="http://static.hecun.site/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20180610122553.png" alt="image"></p> <p>!ref: 表示表格输出的范围<br>
A1-Zx: 这些就对应的是Excel中单元格的位置；</p> <p>其中：Sheet1相关参数介绍：</p> <table><thead><tr><th>键名</th> <th>值</th></tr></thead> <tbody><tr><td>v</td> <td>原始值</td></tr> <tr><td>t</td> <td>b布尔值，e错误，n数字，d日期，s文本</td></tr></tbody></table> <p>更多属性请参照： <a href="https://docs.sheetjs.com/#general-structures" target="_blank" rel="noopener noreferrer">官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <ol start="3"><li>指定导出格式,这里采用xlsx格式</li></ol> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token keyword">const</span> wopts <span class="token operator">=</span> <span class="token punctuation">{</span> bookType<span class="token punctuation">:</span> <span class="token string">'xlsx'</span><span class="token punctuation">,</span> bookSST<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>type<span class="token punctuation">:</span> <span class="token string">'binary'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//这里的数据是用来定义导出的格式类型</span>
<span class="token comment">// const wopts = { bookType: 'csv', bookSST: false, type: 'binary' };//ods格式</span>
<span class="token comment">// const wopts = { bookType: 'ods', bookSST: false, type: 'binary' };//ods格式</span>
<span class="token comment">// const wopts = { bookType: 'xlsb', bookSST: false, type: 'binary' };//xlsb格式</span>
<span class="token comment">// const wopts = { bookType: 'fods', bookSST: false, type: 'binary' };//fods格式</span>
<span class="token comment">// const wopts = { bookType: 'biff2', bookSST: false, type: 'binary' };//xls格式</span>
</code></pre></div><ol start="4"><li>设置表头 将工作表的A1-Z1等替换称为中文</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 将指定的自然数转换为26进制表示。映射关系：[0-25] -&gt; [A-Z]。</span>
<span class="token keyword">function</span> <span class="token function">getCharCol</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> temCol <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
        s <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">,</span>
        m <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m <span class="token operator">=</span> n <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">+</span> <span class="token number">1</span>
        s <span class="token operator">=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>m <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> s
        n <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> m<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">26</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> s
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">[</span><span class="token string">&quot;ID&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;手机号&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;等级&quot;</span> <span class="token punctuation">,</span><span class="token string">&quot;生日&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;积分&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v<span class="token punctuation">,</span>i</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>data<span class="token punctuation">[</span><span class="token function">getCharCol</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> t<span class="token punctuation">:</span> <span class="token string">&quot;s&quot;</span><span class="token punctuation">,</span> v<span class="token punctuation">:</span> v <span class="token punctuation">,</span>w<span class="token punctuation">:</span>v<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="5"><li>下载保存，</li></ol> <p>利用XLSX.write(wb, wopts);<br>
wb: 二进制数据流<br>
wopts: 指定的导出格式等信息</p> <p>下载保存这次不采用a标签的方式。采用<a href="http://sheetjs.com/demos/FileSaver.js" target="_blank" rel="noopener noreferrer">FileSaver.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">saveAs</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">s2ab</span><span class="token punctuation">(</span><span class="token constant">XLSX</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>wb<span class="token punctuation">,</span> wopts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>type<span class="token punctuation">:</span> <span class="token string">&quot;application/octet-stream&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;js-xlsx文件下载实例&quot;</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> wopts<span class="token punctuation">.</span>bookType<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><a href="https://hecun0000.github.io/Jcss/file/xlsxDownload.html" target="_blank" rel="noopener noreferrer">查看演示<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>参考文章：</p> <ol><li><a href="http://www.zhangxinxu.com/wordpress/2013/10/understand-domstring-document-formdata-blob-file-arraybuffer/" target="_blank" rel="noopener noreferrer">理解DOMString、Document、FormData、Blob、File、ArrayBuffer数据类型--张鑫旭<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://javascript.ruanyifeng.com/htmlapi/file.html" target="_blank" rel="noopener noreferrer">文件和二进制数据的操作--阮一峰<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/26/2018, 9:32:41 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c2692aa7.js" defer></script><script src="/assets/js/7.ee9b7330.js" defer></script><script src="/assets/js/2.55ffe7b1.js" defer></script><script src="/assets/js/50.98492dc0.js" defer></script>
  </body>
</html>
